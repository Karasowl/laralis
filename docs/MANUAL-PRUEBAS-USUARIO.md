# üìã Manual de Pruebas de Usuario - Laralis Dental Manager

**Versi√≥n**: 1.0.0
**Fecha**: 2025-10-16
**Usuario de prueba**: ismaelguimarais@gmail.com / test123456

---

## üéØ Objetivo

Este documento lista TODAS las pruebas que debes realizar como usuario para verificar el correcto funcionamiento de la aplicaci√≥n. Cada prueba incluye los pasos exactos y qu√© verificar en cada momento.

---

## üìö √çndice

1. [Autenticaci√≥n y Onboarding](#1-autenticaci√≥n-y-onboarding)
2. [Configuraci√≥n de Tiempo](#2-configuraci√≥n-de-tiempo)
3. [Costos Fijos](#3-costos-fijos)
4. [Activos](#4-activos)
5. [Insumos](#5-insumos)
6. [Servicios](#6-servicios)
7. [Pacientes](#7-pacientes)
8. [Tratamientos](#8-tratamientos)
9. [Gastos](#9-gastos)
10. [Tarifas](#10-tarifas)
11. [Dashboard](#11-dashboard)
12. [Reportes](#12-reportes)
13. [Punto de Equilibrio](#13-punto-de-equilibrio)
14. [Marketing](#14-marketing)
15. [Configuraci√≥n](#15-configuraci√≥n)
16. [Multi-tenancy](#16-multi-tenancy)

---

## 1. Autenticaci√≥n y Onboarding

### 1.1 Registro de Usuario Nuevo
**No automatizable - requiere verificaci√≥n de email**

#### Pasos:
1. Ir a `/auth/register`
2. Llenar formulario con email v√°lido
3. Enviar formulario

#### Verificar:
- ‚úÖ Recibir email de verificaci√≥n
- ‚úÖ Clic en link del email te lleva a `/auth/verify-email`
- ‚úÖ Mensaje de √©xito despu√©s de verificar
- ‚úÖ Redirect autom√°tico a `/onboarding`

---

### 1.2 Login
**Automatizable**

#### Pasos:
1. Ir a `/auth/login`
2. Ingresar: `ismaelguimarais@gmail.com` / `test123456`
3. Click en "Iniciar Sesi√≥n"

#### Verificar:
- ‚úÖ Si no tiene onboarding ‚Üí redirect a `/onboarding`
- ‚úÖ Si tiene onboarding completo ‚Üí redirect a `/` (dashboard)
- ‚úÖ Token guardado en localStorage/cookies
- ‚úÖ Sidebar muestra nombre de usuario
- ‚úÖ Selector de cl√≠nicas visible (si tiene m√°s de una)

---

### 1.3 Onboarding - Crear Workspace y Cl√≠nica
**Obligatorio despu√©s del registro**

#### Pasos:
1. Despu√©s de login, deber√≠as estar en `/onboarding`
2. **Paso 1 - Workspace**:
   - Nombre: "Mi Consultorio Dental"
   - Click "Continuar"
3. **Paso 2 - Primera Cl√≠nica**:
   - Nombre: "Cl√≠nica Centro"
   - Direcci√≥n: "Av. Principal 123"
   - Tel√©fono: "1234567890" (opcional)
   - Click "Finalizar"

#### Verificar:
- ‚úÖ Despu√©s de crear workspace, avanza autom√°ticamente a paso 2
- ‚úÖ Despu√©s de crear cl√≠nica, redirect a `/setup`
- ‚úÖ En `/setup` aparece mensaje "¬°Bienvenido! Completa la configuraci√≥n inicial"
- ‚úÖ Sidebar ya muestra las secciones de la app
- ‚úÖ El selector de cl√≠nicas en sidebar muestra "Cl√≠nica Centro"

---

### 1.4 Setup Inicial
**Configuraci√≥n obligatoria antes de usar la app**

#### Pasos en `/setup`:
1. **Configuraci√≥n de Tiempo**:
   - D√≠as laborales: 20
   - Horas por d√≠a: 8
   - Porcentaje real: 75 (representa 75% = 0.75)
   - Click "Guardar"

2. **Costos Fijos** (al menos uno):
   - Categor√≠a: "Renta"
   - Concepto: "Renta mensual consultorio"
   - Monto: $10,000.00
   - Click "Agregar"

3. Click en "Completar Configuraci√≥n"

#### Verificar:
- ‚úÖ Despu√©s de guardar tiempo, aparece secci√≥n de costos fijos
- ‚úÖ Despu√©s de agregar costo fijo, el bot√≥n "Completar Configuraci√≥n" se habilita
- ‚úÖ Al completar, redirect a `/` (dashboard)
- ‚úÖ Dashboard muestra datos iniciales
- ‚úÖ Costo por minuto se calcula autom√°ticamente

---

### 1.5 Logout
**Automatizable**

#### Pasos:
1. Click en tu nombre de usuario (arriba a la derecha)
2. Click en "Cerrar Sesi√≥n"

#### Verificar:
- ‚úÖ Redirect a `/auth/login`
- ‚úÖ Token eliminado
- ‚úÖ No puedes acceder a rutas protegidas sin login

---

### 1.6 Recuperar Contrase√±a
**No automatizable - requiere email**

#### Pasos:
1. En `/auth/login`, click "¬øOlvidaste tu contrase√±a?"
2. Ir a `/auth/forgot-password`
3. Ingresar email
4. Enviar

#### Verificar:
- ‚úÖ Recibir email con link de reset
- ‚úÖ Link te lleva a `/auth/reset-password?token=...`
- ‚úÖ Puedes ingresar nueva contrase√±a
- ‚úÖ Despu√©s de reset, puedes hacer login con nueva contrase√±a

---

## 2. Configuraci√≥n de Tiempo

**Ruta**: `/time`
**Dependencias**: Ninguna
**Impacto**: Afecta c√°lculo de costo fijo por minuto

---

### 2.1 Ver Configuraci√≥n Actual

#### Pasos:
1. Ir a `/time`

#### Verificar:
- ‚úÖ Se muestra configuraci√≥n actual (si existe)
- ‚úÖ Se muestra c√°lculo en vivo:
  - D√≠as laborales √ó Horas por d√≠a = Horas totales
  - Horas totales √ó Porcentaje real = Horas efectivas
  - Horas efectivas √ó 60 = Minutos efectivos mensuales
- ‚úÖ Si hay costos fijos, se muestra "Costo por minuto"

---

### 2.2 Crear/Editar Configuraci√≥n

#### Pasos:
1. En `/time`, llenar formulario:
   - D√≠as laborales: 22
   - Horas por d√≠a: 8
   - Porcentaje real: 80
2. Click "Guardar"

#### Verificar:
- ‚úÖ Mensaje de √©xito
- ‚úÖ C√°lculos se actualizan en vivo
- ‚úÖ Si cambias los valores, el c√°lculo se recalcula inmediatamente
- ‚úÖ Costo por minuto se actualiza (si hay costos fijos)
- ‚úÖ **CR√çTICO**: Ve a Dashboard y verifica que el KPI de "Costo/Minuto" refleje el nuevo valor

---

### 2.3 Validaciones

#### Probar:
1. D√≠as laborales = 0 ‚Üí debe dar error
2. D√≠as laborales = -5 ‚Üí debe dar error
3. Horas por d√≠a = 0 ‚Üí debe dar error
4. Porcentaje real = 0 ‚Üí debe dar error
5. Porcentaje real = 150 ‚Üí debe dar error (m√°ximo 100)

#### Verificar:
- ‚úÖ No permite guardar valores inv√°lidos
- ‚úÖ Muestra mensajes de error claros

---

## 3. Costos Fijos

**Ruta**: `/fixed-costs`
**Dependencias**: Configuraci√≥n de tiempo debe existir
**Impacto**: Afecta costo por minuto y punto de equilibrio

---

### 3.1 Listar Costos Fijos

#### Pasos:
1. Ir a `/fixed-costs`

#### Verificar:
- ‚úÖ Tabla muestra todos los costos fijos
- ‚úÖ Columnas: Categor√≠a, Concepto, Monto, Acciones
- ‚úÖ Montos se muestran en formato moneda (MXN)
- ‚úÖ Hay un total al final de la tabla
- ‚úÖ Si no hay costos, muestra EmptyState con bot√≥n "Agregar primero"

---

### 3.2 Crear Costo Fijo

#### Pasos:
1. Click en "Agregar Costo Fijo"
2. Llenar:
   - Categor√≠a: "Servicios"
   - Concepto: "Internet y tel√©fono"
   - Monto: $1,500.00
3. Click "Guardar"

#### Verificar:
- ‚úÖ Modal se cierra
- ‚úÖ Mensaje de √©xito
- ‚úÖ Nuevo costo aparece en la tabla
- ‚úÖ Total se actualiza
- ‚úÖ **CR√çTICO**: Ve a `/time` y verifica que "Costo por minuto" se actualiz√≥
- ‚úÖ **CR√çTICO**: Ve a Dashboard y verifica que el KPI "Costo/Minuto" refleje el cambio

---

### 3.3 Editar Costo Fijo

#### Pasos:
1. En tabla, click en icono de editar (Pencil)
2. Cambiar monto a $2,000.00
3. Click "Guardar"

#### Verificar:
- ‚úÖ Modal se cierra
- ‚úÖ Mensaje de √©xito
- ‚úÖ Monto actualizado en tabla
- ‚úÖ Total recalculado
- ‚úÖ Costo por minuto actualizado (verificar en `/time`)

---

### 3.4 Eliminar Costo Fijo

#### Pasos:
1. Click en icono de eliminar (Trash)
2. Confirmar en el di√°logo

#### Verificar:
- ‚úÖ Di√°logo de confirmaci√≥n aparece
- ‚úÖ Mensaje de √©xito despu√©s de eliminar
- ‚úÖ Costo desaparece de la tabla
- ‚úÖ Total se actualiza
- ‚úÖ Si eliminas todos, aparece EmptyState
- ‚úÖ Costo por minuto se actualiza

---

### 3.5 Categor√≠as de Costos Fijos

#### Categor√≠as comunes a probar:
- Renta
- Servicios (luz, agua, internet)
- Salarios
- Seguros
- Mantenimiento
- Marketing
- Otros

#### Verificar:
- ‚úÖ Puedes filtrar por categor√≠a (si existe filtro)
- ‚úÖ Total por categor√≠a se muestra correctamente

---

## 4. Activos

**Ruta**: `/assets`
**Dependencias**: Ninguna
**Impacto**: Afecta c√°lculo de depreciaci√≥n en costo fijo por minuto

---

### 4.1 Listar Activos

#### Pasos:
1. Ir a `/assets`

#### Verificar:
- ‚úÖ Tabla con: Nombre, Costo inicial, Vida √∫til, Valor residual, Depreciaci√≥n mensual, Acciones
- ‚úÖ Card con resumen en la parte superior:
  - Valor Total de Activos
  - Depreciaci√≥n Mensual Total
  - Vida √ötil Promedio
- ‚úÖ Valores monetarios en formato MXN

---

### 4.2 Crear Activo

#### Pasos:
1. Click "Agregar Activo"
2. Llenar formulario:
   - Nombre: "Sill√≥n Dental Profesional"
   - Costo Inicial: $50,000.00
   - Vida √ötil: 60 meses (5 a√±os)
   - Valor Residual: $5,000.00
3. Click "Guardar"

#### Verificar:
- ‚úÖ Modal se cierra
- ‚úÖ Mensaje de √©xito
- ‚úÖ Activo aparece en tabla
- ‚úÖ **Depreciaci√≥n mensual calculada correctamente**:
  - F√≥rmula: (Costo Inicial - Valor Residual) / Vida √ötil
  - Esperado: ($50,000 - $5,000) / 60 = $750.00/mes
- ‚úÖ Resumen actualizado:
  - Valor total aumenta
  - Depreciaci√≥n mensual total aumenta
  - Vida √∫til promedio se recalcula

---

### 4.3 Editar Activo

#### Pasos:
1. Click en editar (Pencil)
2. Cambiar vida √∫til a 48 meses
3. Guardar

#### Verificar:
- ‚úÖ Depreciaci√≥n mensual se recalcula: ($50,000 - $5,000) / 48 = $937.50/mes
- ‚úÖ Resumen actualizado

---

### 4.4 Eliminar Activo

#### Pasos:
1. Click en eliminar (Trash)
2. Confirmar

#### Verificar:
- ‚úÖ Activo eliminado
- ‚úÖ Resumen actualizado

---

### 4.5 Verificaci√≥n de C√°lculos

#### Crear varios activos y verificar:

**Activo 1: Unidad Dental**
- Costo: $80,000
- Vida √∫til: 72 meses
- Valor residual: $8,000
- **Depreciaci√≥n esperada**: $1,000/mes

**Activo 2: Rayos X**
- Costo: $120,000
- Vida √∫til: 96 meses
- Valor residual: $12,000
- **Depreciaci√≥n esperada**: $1,125/mes

**Activo 3: Compresor**
- Costo: $15,000
- Vida √∫til: 60 meses
- Valor residual: $1,500
- **Depreciaci√≥n esperada**: $225/mes

#### Verificar:
- ‚úÖ Depreciaci√≥n mensual total = $2,350/mes
- ‚úÖ Valor total activos = $215,000
- ‚úÖ Vida √∫til promedio = 76 meses

---

## 5. Insumos

**Ruta**: `/supplies`
**Dependencias**: Ninguna
**Impacto**: Afecta costo variable de servicios y tratamientos

---

### 5.1 Listar Insumos

#### Pasos:
1. Ir a `/supplies`

#### Verificar:
- ‚úÖ Tabla con: Nombre, Categor√≠a, Precio, Porciones, Costo/Porci√≥n, Acciones
- ‚úÖ Filtros funcionales:
  - Por categor√≠a
  - B√∫squeda por nombre
- ‚úÖ **Costo por porci√≥n calculado**: Precio / Porciones

---

### 5.2 Crear Insumo

#### Pasos:
1. Click "Agregar Insumo"
2. Llenar:
   - Nombre: "Composite Universal"
   - Categor√≠a: "Materiales"
   - Precio: $500.00
   - Porciones: 20
   - Unidad: "aplicaciones"
   - Notas: "Composite fotopolimerizable"
3. Guardar

#### Verificar:
- ‚úÖ Insumo aparece en tabla
- ‚úÖ **Costo/Porci√≥n**: $500.00 / 20 = $25.00
- ‚úÖ Filtro por categor√≠a "Materiales" muestra el insumo

---

### 5.3 Crear M√∫ltiples Insumos de Prueba

**Crear los siguientes para pruebas posteriores:**

**Insumo 1: Anestesia**
- Precio: $200.00
- Porciones: 50
- Categor√≠a: "Medicamentos"
- **Costo/Porci√≥n**: $4.00

**Insumo 2: Guantes (caja)**
- Precio: $150.00
- Porciones: 100
- Categor√≠a: "Desechables"
- **Costo/Porci√≥n**: $1.50

**Insumo 3: Amalgama**
- Precio: $800.00
- Porciones: 30
- Categor√≠a: "Materiales"
- **Costo/Porci√≥n**: $26.67

**Insumo 4: Hilo Dental (rollo)**
- Precio: $50.00
- Porciones: 25
- Categor√≠a: "Desechables"
- **Costo/Porci√≥n**: $2.00

#### Verificar:
- ‚úÖ Todos los insumos aparecen en tabla
- ‚úÖ C√°lculos de costo/porci√≥n correctos
- ‚úÖ Filtros funcionan

---

### 5.4 Editar Insumo

#### Pasos:
1. Editar "Composite Universal"
2. Cambiar precio a $600.00
3. Guardar

#### Verificar:
- ‚úÖ Costo/Porci√≥n actualizado: $600 / 20 = $30.00
- ‚úÖ **IMPORTANTE**: Ir a servicios que usen este insumo y verificar que el costo variable se actualiz√≥

---

### 5.5 Eliminar Insumo

#### Pasos:
1. Intentar eliminar "Composite Universal" (si est√° en alg√∫n servicio)

#### Verificar:
- ‚úÖ Si est√° en uso, debe mostrar error o advertencia
- ‚úÖ Si no est√° en uso, se elimina correctamente

---

## 6. Servicios

**Ruta**: `/services`
**Dependencias**: Insumos deben existir
**Impacto**: Afecta tratamientos y tarifas

---

### 6.1 Listar Servicios

#### Pasos:
1. Ir a `/services`

#### Verificar:
- ‚úÖ Tabla con: Nombre, Duraci√≥n, Costo Variable, Acciones
- ‚úÖ Duraci√≥n en minutos
- ‚úÖ Costo variable en MXN

---

### 6.2 Crear Servicio Simple (sin insumos)

#### Pasos:
1. Click "Agregar Servicio"
2. Llenar:
   - Nombre: "Consulta General"
   - Duraci√≥n: 30 minutos
   - No agregar insumos
3. Guardar

#### Verificar:
- ‚úÖ Servicio creado
- ‚úÖ Costo variable = $0.00
- ‚úÖ En vista de detalle, secci√≥n de insumos vac√≠a

---

### 6.3 Crear Servicio con Insumos (Receta)

#### Pasos:
1. Click "Agregar Servicio"
2. Llenar:
   - Nombre: "Resina Compuesta"
   - Duraci√≥n: 45 minutos
3. **Agregar insumos** (click "Agregar Insumo"):
   - Insumo 1: "Composite Universal" ‚Üí Cantidad: 2 porciones
   - Insumo 2: "Anestesia" ‚Üí Cantidad: 1 porci√≥n
   - Insumo 3: "Guantes" ‚Üí Cantidad: 2 porciones
4. Guardar

#### Verificar MIENTRAS LLENAS EL FORMULARIO:
- ‚úÖ **Preview en vivo del costo variable**:
  - Composite: 2 √ó $30.00 = $60.00
  - Anestesia: 1 √ó $4.00 = $4.00
  - Guantes: 2 √ó $1.50 = $3.00
  - **Total esperado**: $67.00

#### Verificar DESPU√âS DE GUARDAR:
- ‚úÖ Servicio aparece en tabla con costo variable = $67.00
- ‚úÖ Click en el servicio para ver detalle
- ‚úÖ Detalle muestra:
  - Lista de insumos con cantidades
  - Costo individual de cada insumo
  - Costo variable total
  - Duraci√≥n en minutos

---

### 6.4 Crear Servicio Complejo

#### Pasos:
1. Crear servicio "Corona de Porcelana"
2. Duraci√≥n: 90 minutos
3. Agregar insumos:
   - Anestesia: 2
   - Guantes: 4
   - Composite: 3
   - Hilo Dental: 1

#### Verificar c√°lculo:
- ‚úÖ Anestesia: 2 √ó $4.00 = $8.00
- ‚úÖ Guantes: 4 √ó $1.50 = $6.00
- ‚úÖ Composite: 3 √ó $30.00 = $90.00
- ‚úÖ Hilo Dental: 1 √ó $2.00 = $2.00
- ‚úÖ **Total**: $106.00

---

### 6.5 Editar Servicio - Cambiar Duraci√≥n

#### Pasos:
1. Editar "Resina Compuesta"
2. Cambiar duraci√≥n de 45 a 60 minutos
3. Guardar

#### Verificar:
- ‚úÖ Duraci√≥n actualizada
- ‚úÖ Costo variable NO cambia (solo cambia si modificas insumos)
- ‚úÖ **IMPORTANTE**: Cuando crees un tratamiento con este servicio, el costo fijo debe calcularse con 60 minutos

---

### 6.6 Editar Servicio - Modificar Insumos

#### Pasos:
1. Editar "Resina Compuesta"
2. Cambiar cantidad de Composite de 2 a 3 porciones
3. Guardar

#### Verificar:
- ‚úÖ **C√°lculo actualizado**:
  - Composite: 3 √ó $30.00 = $90.00
  - Anestesia: 1 √ó $4.00 = $4.00
  - Guantes: 2 √ó $1.50 = $3.00
  - **Nuevo total**: $97.00
- ‚úÖ Tabla refleja nuevo costo variable
- ‚úÖ **CR√çTICO**: Los tratamientos NUEVOS usan el nuevo costo, pero los tratamientos EXISTENTES mantienen el snapshot antiguo

---

### 6.7 Eliminar Servicio

#### Pasos:
1. Intentar eliminar servicio que tiene tratamientos asociados

#### Verificar:
- ‚úÖ Debe mostrar error o advertencia
- ‚úÖ Eliminar servicio sin tratamientos funciona correctamente

---

## 7. Pacientes

**Ruta**: `/patients`
**Dependencias**: Ninguna
**Impacto**: Requerido para crear tratamientos

---

### 7.1 Listar Pacientes

#### Pasos:
1. Ir a `/patients`

#### Verificar:
- ‚úÖ Tabla con: Nombre, Email, Tel√©fono, Fecha de registro, Acciones
- ‚úÖ B√∫squeda funciona
- ‚úÖ Si no hay pacientes, EmptyState

---

### 7.2 Crear Paciente

#### Pasos:
1. Click "Agregar Paciente"
2. Llenar:
   - Nombre: "Juan P√©rez"
   - Email: "juan@example.com"
   - Tel√©fono: "5551234567"
   - Fecha de nacimiento: "15/05/1985"
   - Direcci√≥n: "Calle Falsa 123"
   - Notas: "Al√©rgico a la penicilina"
3. Guardar

#### Verificar:
- ‚úÖ Paciente aparece en tabla
- ‚úÖ Edad calculada correctamente a partir de fecha de nacimiento
- ‚úÖ B√∫squeda por nombre funciona

---

### 7.3 Crear Pacientes de Prueba

**Crear al menos 5 pacientes para pruebas posteriores:**

1. Mar√≠a Gonz√°lez - maria@example.com
2. Pedro Mart√≠nez - pedro@example.com
3. Ana L√≥pez - ana@example.com
4. Carlos Rodr√≠guez - carlos@example.com
5. Laura S√°nchez - laura@example.com

---

### 7.4 Editar Paciente

#### Pasos:
1. Editar "Juan P√©rez"
2. Cambiar tel√©fono
3. Agregar en notas: "√öltima limpieza: 01/03/2024"
4. Guardar

#### Verificar:
- ‚úÖ Cambios guardados
- ‚úÖ Historial de tratamientos NO se afecta

---

### 7.5 Ver Detalle de Paciente

#### Pasos:
1. Click en nombre del paciente

#### Verificar:
- ‚úÖ Vista de detalle con informaci√≥n completa
- ‚úÖ **Historial de tratamientos** (si tiene)
- ‚úÖ Total gastado por el paciente
- ‚úÖ √öltima visita
- ‚úÖ Bot√≥n para crear nuevo tratamiento

---

### 7.6 Eliminar Paciente

#### Pasos:
1. Intentar eliminar paciente con tratamientos

#### Verificar:
- ‚úÖ Debe mostrar advertencia
- ‚úÖ Eliminar paciente sin tratamientos funciona

---

## 8. Tratamientos

**Ruta**: `/treatments`
**Dependencias**: Pacientes, Servicios, Configuraci√≥n de Tiempo, Costos Fijos
**Impacto**: Genera ingresos, afecta reportes y dashboard

---

### 8.1 Listar Tratamientos

#### Pasos:
1. Ir a `/treatments`

#### Verificar:
- ‚úÖ Tabla con: Fecha, Paciente, Servicio, Precio, Estado, Acciones
- ‚úÖ Filtros:
  - Por fecha (rango)
  - Por paciente
  - Por servicio
  - Por estado (completado, pendiente, cancelado)
- ‚úÖ Ordenamiento por fecha (m√°s reciente primero)

---

### 8.2 Crear Tratamiento - Flujo Completo

#### Pre-requisitos:
- ‚úÖ Configuraci√≥n de tiempo creada (ej: 20 d√≠as, 8 horas, 75%)
- ‚úÖ Costos fijos creados (ej: total $15,000/mes)
- ‚úÖ Costo por minuto calculado (ej: $15.63/min)
- ‚úÖ Servicio "Resina Compuesta" creado:
  - Duraci√≥n: 60 minutos
  - Costo variable: $97.00

#### Pasos:
1. Click "Agregar Tratamiento"
2. Llenar:
   - Paciente: "Juan P√©rez"
   - Servicio: "Resina Compuesta"
   - Fecha: Hoy
   - **Observar que se auto-cargan:**
     - Duraci√≥n: 60 minutos
     - Margen: 40% (valor por defecto)
3. **ANTES de guardar, verificar el preview de costos:**

#### Verificar C√ÅLCULOS EN VIVO:
```
Duraci√≥n del servicio: 60 min
Costo fijo por minuto: $15.63/min

1. Costo Fijo = 60 min √ó $15.63/min = $937.80
2. Costo Variable = $97.00 (del servicio)
3. Costo Base = $937.80 + $97.00 = $1,034.80
4. Margen (40%) = $1,034.80 √ó 0.40 = $413.92
5. Precio Final = $1,034.80 + $413.92 = $1,448.72
```

#### Verificar:
- ‚úÖ Preview muestra desglose de costos
- ‚úÖ **Precio final sugerido**: ~$1,448.72
- ‚úÖ Puedes ajustar el margen y ver c√≥mo cambia el precio
- ‚úÖ Puedes sobrescribir el precio manualmente

4. Click "Guardar"

#### Verificar DESPU√âS de guardar:
- ‚úÖ Tratamiento aparece en tabla con precio correcto
- ‚úÖ **Ir al Dashboard**:
  - Total de ingresos aumenta
  - Contador de tratamientos aumenta
  - Gr√°fica de ingresos muestra el nuevo punto
- ‚úÖ **Ir al perfil del paciente "Juan P√©rez"**:
  - Tratamiento aparece en su historial
  - Total gastado por el paciente se actualiza

---

### 8.3 Crear Tratamiento con Diferentes M√°rgenes

#### Crear 3 tratamientos con el mismo servicio pero m√°rgenes diferentes:

**Tratamiento 1: Margen 30%**
- Paciente: Mar√≠a Gonz√°lez
- Servicio: Resina Compuesta
- Margen: 30%
- **Precio esperado**: $1,034.80 √ó 1.30 = $1,345.24

**Tratamiento 2: Margen 50%**
- Paciente: Pedro Mart√≠nez
- Servicio: Resina Compuesta
- Margen: 50%
- **Precio esperado**: $1,034.80 √ó 1.50 = $1,552.20

**Tratamiento 3: Margen 60%**
- Paciente: Ana L√≥pez
- Servicio: Resina Compuesta
- Margen: 60%
- **Precio esperado**: $1,034.80 √ó 1.60 = $1,655.68

#### Verificar:
- ‚úÖ Cada tratamiento tiene precio diferente
- ‚úÖ Dashboard refleja todos los ingresos
- ‚úÖ Reportes muestran margen promedio correcto

---

### 8.4 Crear Tratamiento con Precio Personalizado

#### Pasos:
1. Crear nuevo tratamiento
2. En lugar de usar el precio sugerido, ingresar manualmente: $2,000.00
3. Guardar

#### Verificar:
- ‚úÖ Precio guardado es $2,000.00 (no el calculado)
- ‚úÖ Snapshot de costos se guarda correctamente
- ‚úÖ En reportes, puedes ver el margen real logrado

---

### 8.5 Verificar Snapshot Inmutable

#### Objetivo: Verificar que cambiar servicios/insumos NO afecta tratamientos hist√≥ricos

#### Pasos:
1. Crear tratamiento con "Resina Compuesta" (precio actual)
2. **Anotar el precio del tratamiento**: Ej. $1,448.72
3. Ir a `/supplies` y editar "Composite Universal":
   - Cambiar precio de $600 a $800
   - Nuevo costo/porci√≥n: $40.00
4. Ir a `/services` y ver "Resina Compuesta":
   - **Nuevo costo variable**: 3 √ó $40 + $4 + $3 = $127.00 (aument√≥ $30)
5. **Volver a `/treatments`**

#### Verificar:
- ‚úÖ El tratamiento anterior SIGUE mostrando $1,448.72
- ‚úÖ NO se recalcul√≥ con el nuevo costo variable
- ‚úÖ Si creas un tratamiento NUEVO con el mismo servicio:
  - Costo variable ser√° $127.00
  - Precio ser√° mayor: ~$1,478.72

**Esto es CR√çTICO**: Los tratamientos guardan un snapshot inmutable de los costos al momento de creaci√≥n.

---

### 8.6 Editar Tratamiento

#### Pasos:
1. Editar un tratamiento existente
2. Cambiar fecha
3. Cambiar estado a "Completado"
4. Agregar notas: "Paciente satisfecho"
5. Guardar

#### Verificar:
- ‚úÖ Cambios guardados
- ‚úÖ **Precio NO se recalcula** (usa snapshot original)
- ‚úÖ En dashboard, tratamientos "Completados" vs "Pendientes" se reflejan correctamente

---

### 8.7 Eliminar Tratamiento

#### Pasos:
1. Eliminar un tratamiento
2. Confirmar

#### Verificar:
- ‚úÖ Tratamiento eliminado
- ‚úÖ **Dashboard actualizado**:
  - Total de ingresos disminuye
  - Contador de tratamientos disminuye
- ‚úÖ En perfil del paciente, el tratamiento ya no aparece

---

### 8.8 Crear Tratamientos en Diferentes Fechas (Para Reportes)

#### Crear 10 tratamientos distribuidos en 3 meses:

**Mes 1 (Enero 2024):**
- 3 tratamientos de diferentes servicios
- Total: ~$4,000

**Mes 2 (Febrero 2024):**
- 4 tratamientos
- Total: ~$6,000

**Mes 3 (Marzo 2024):**
- 3 tratamientos
- Total: ~$5,000

#### Verificar:
- ‚úÖ Dashboard muestra datos del mes actual
- ‚úÖ Reportes permiten filtrar por mes
- ‚úÖ Gr√°ficas muestran evoluci√≥n mensual

---

## 9. Gastos

**Ruta**: `/expenses`
**Dependencias**: Ninguna (pero se usan en reportes)
**Impacto**: Afecta an√°lisis de rentabilidad

---

### 9.1 Listar Gastos

#### Pasos:
1. Ir a `/expenses`

#### Verificar:
- ‚úÖ Tabla con: Fecha, Categor√≠a, Concepto, Monto, Acciones
- ‚úÖ Filtros:
  - Por fecha
  - Por categor√≠a
  - B√∫squeda por concepto
- ‚úÖ Tarjetas de resumen:
  - Total del mes actual
  - Promedio mensual
  - Categor√≠a con m√°s gasto

---

### 9.2 Crear Gasto

#### Pasos:
1. Click "Agregar Gasto"
2. Llenar:
   - Fecha: Hoy
   - Categor√≠a: "Insumos"
   - Concepto: "Compra de materiales dentales"
   - Monto: $3,500.00
   - Notas: "Proveedor X"
3. Guardar

#### Verificar:
- ‚úÖ Gasto aparece en tabla
- ‚úÖ Resumen actualizado:
  - Total del mes aumenta
- ‚úÖ Dashboard muestra el gasto (si tiene widget de gastos)

---

### 9.3 Crear Gastos por Categor√≠a

**Crear al menos un gasto de cada categor√≠a:**

1. **Insumos**: Compra de materiales - $3,500
2. **Mantenimiento**: Reparaci√≥n de equipo - $1,200
3. **Marketing**: Anuncios en redes sociales - $800
4. **Salarios**: Pago asistente - $8,000
5. **Servicios**: Luz y agua - $600
6. **Otros**: Capacitaci√≥n - $1,500

#### Verificar:
- ‚úÖ Filtro por categor√≠a funciona
- ‚úÖ Resumen muestra categor√≠a con m√°s gasto
- ‚úÖ **Ir a Reportes** y verificar que se reflejan en el an√°lisis de gastos

---

### 9.4 Editar Gasto

#### Pasos:
1. Editar un gasto
2. Cambiar monto
3. Guardar

#### Verificar:
- ‚úÖ Cambios guardados
- ‚úÖ Resumen actualizado
- ‚úÖ Reportes actualizados

---

### 9.5 Eliminar Gasto

#### Pasos:
1. Eliminar gasto
2. Confirmar

#### Verificar:
- ‚úÖ Gasto eliminado
- ‚úÖ Resumen actualizado

---

### 9.6 Alertas de Gastos (Si existe)

#### Si hay sistema de alertas:
1. Configurar alerta: "Gastos en Insumos > $5,000"
2. Crear gasto de $6,000 en Insumos

#### Verificar:
- ‚úÖ Alerta se dispara
- ‚úÖ Notificaci√≥n visible en dashboard

---

## 10. Tarifas

**Ruta**: `/tariffs`
**Dependencias**: Configuraci√≥n de Tiempo, Servicios
**Impacto**: Precios sugeridos para tratamientos

---

### 10.1 Listar Tarifas

#### Pasos:
1. Ir a `/tariffs`

#### Verificar:
- ‚úÖ Tabla con todos los servicios
- ‚úÖ Columnas:
  - Servicio
  - Duraci√≥n (min)
  - Costo Fijo
  - Costo Variable
  - Costo Base
  - Margen (%)
  - Precio Sugerido
- ‚úÖ Cada fila muestra c√°lculo completo

---

### 10.2 Ver Desglose de Tarifa

#### Pasos:
1. Click en un servicio para ver detalle

#### Verificar desglose completo:
```
Servicio: Resina Compuesta
Duraci√≥n: 60 min
Costo por minuto: $15.63

Costos:
- Costo Fijo: 60 √ó $15.63 = $937.80
- Costo Variable: $127.00
- Costo Base: $1,064.80

M√°rgenes sugeridos:
- 30%: $1,384.24
- 40%: $1,490.72
- 50%: $1,597.20
- 60%: $1,703.68
```

#### Verificar:
- ‚úÖ C√°lculos matem√°ticos correctos
- ‚úÖ M√∫ltiples opciones de margen
- ‚úÖ Puedes copiar precio para usarlo en tratamientos

---

### 10.3 Actualizaci√≥n Autom√°tica de Tarifas

#### Escenario: Cambiar costo por minuto y verificar actualizaci√≥n

#### Pasos:
1. **Anotar tarifa actual** de "Resina Compuesta": Ej. $1,490.72 (40% margen)
2. Ir a `/fixed-costs`
3. Agregar nuevo costo fijo: $2,000
4. **Verificar en `/time`** que costo/minuto aument√≥ (ej: de $15.63 a $17.71)
5. **Volver a `/tariffs`**

#### Verificar:
- ‚úÖ **Precio sugerido se actualiz√≥ autom√°ticamente**:
  - Nuevo costo fijo: 60 √ó $17.71 = $1,062.60
  - Costo base: $1,062.60 + $127.00 = $1,189.60
  - Precio (40%): $1,665.44
- ‚úÖ Todos los servicios reflejan el nuevo costo/minuto
- ‚úÖ Los tratamientos EXISTENTES siguen con su snapshot antiguo
- ‚úÖ Los tratamientos NUEVOS usar√°n las nuevas tarifas

---

### 10.4 Impacto de Cambio en Insumos

#### Pasos:
1. Editar insumo usado en servicio
2. Aumentar precio
3. Volver a `/tariffs`

#### Verificar:
- ‚úÖ Costo variable del servicio aument√≥
- ‚úÖ Precio sugerido aument√≥
- ‚úÖ Tratamientos nuevos usar√°n nuevo precio

---

## 11. Dashboard

**Ruta**: `/` (p√°gina principal)
**Dependencias**: Todas las dem√°s secciones
**Impacto**: Vista consolidada de la operaci√≥n

---

### 11.1 KPIs Principales

#### Verificar que se muestran:

1. **Ingresos del Mes**
   - Suma de todos los tratamientos del mes actual
   - Comparaci√≥n con mes anterior (% de cambio)

2. **Tratamientos Realizados**
   - Contador de tratamientos del mes
   - Comparaci√≥n con mes anterior

3. **Pacientes Nuevos**
   - Pacientes registrados este mes
   - Comparaci√≥n con mes anterior

4. **Costo por Minuto**
   - Calculado de Configuraci√≥n de Tiempo + Costos Fijos
   - Icono de alerta si no est√° configurado

#### Verificar interactividad:
- ‚úÖ Click en cada KPI lleva a secci√≥n correspondiente
- ‚úÖ Iconos de tendencia (‚Üë‚Üì) funcionan
- ‚úÖ Colores: verde para aumento, rojo para disminuci√≥n

---

### 11.2 Gr√°fica de Ingresos

#### Verificar:
- ‚úÖ Muestra √∫ltimos 6-12 meses
- ‚úÖ Barras/l√≠neas con valores correctos
- ‚úÖ Tooltips muestran valor exacto al hover
- ‚úÖ Eje X: meses
- ‚úÖ Eje Y: montos en MXN
- ‚úÖ Permite cambiar vista (mensual/semanal/diaria)

---

### 11.3 Gr√°fica de Tratamientos por Servicio

#### Verificar:
- ‚úÖ Muestra distribuci√≥n de servicios
- ‚úÖ Top 5 servicios m√°s realizados
- ‚úÖ Porcentajes suman 100%
- ‚úÖ Colores diferentes por servicio

---

### 11.4 √öltimos Tratamientos

#### Verificar:
- ‚úÖ Lista de √∫ltimos 5-10 tratamientos
- ‚úÖ Muestra: Fecha, Paciente, Servicio, Monto
- ‚úÖ Click en tratamiento lleva a detalle
- ‚úÖ Bot√≥n "Ver todos" lleva a `/treatments`

---

### 11.5 Pr√≥ximas Citas (Si existe)

#### Si hay m√≥dulo de citas:
- ‚úÖ Lista de citas del d√≠a/semana
- ‚úÖ Estado: Confirmada, Pendiente, Cancelada
- ‚úÖ Acciones r√°pidas (confirmar, cancelar)

---

### 11.6 Alertas y Notificaciones

#### Verificar:
- ‚úÖ Alerta si no hay configuraci√≥n de tiempo
- ‚úÖ Alerta si no hay costos fijos
- ‚úÖ Alerta si no hay servicios creados
- ‚úÖ Notificaci√≥n de gastos elevados (si aplica)

---

### 11.7 Actualizaci√≥n en Tiempo Real

#### Flujo de prueba:
1. Estar en Dashboard
2. Abrir nueva pesta√±a
3. Crear un nuevo tratamiento
4. Volver al Dashboard

#### Verificar:
- ‚úÖ Refrescar p√°gina muestra nuevos datos
- ‚úÖ (Si hay real-time) Los KPIs se actualizan autom√°ticamente

---

## 12. Reportes

**Ruta**: `/reports`
**Dependencias**: Tratamientos, Gastos
**Impacto**: An√°lisis de rentabilidad y toma de decisiones

---

### 12.1 Reporte de Ingresos

#### Pasos:
1. Ir a `/reports`
2. Seleccionar "Reporte de Ingresos"
3. Filtrar por mes actual

#### Verificar:
- ‚úÖ **Total de ingresos**: Suma de todos los tratamientos del mes
- ‚úÖ **Desglose por servicio**: Cu√°nto gener√≥ cada servicio
- ‚úÖ **Desglose por paciente**: Top pacientes que m√°s gastaron
- ‚úÖ **Promedio por tratamiento**: Total / N√∫mero de tratamientos
- ‚úÖ **Tratamientos por d√≠a**: Distribuci√≥n en el mes
- ‚úÖ Gr√°ficas visuales
- ‚úÖ Bot√≥n de exportar a PDF/Excel

---

### 12.2 Reporte de Gastos

#### Pasos:
1. Seleccionar "Reporte de Gastos"
2. Filtrar por mes

#### Verificar:
- ‚úÖ **Total de gastos** del mes
- ‚úÖ **Desglose por categor√≠a**: Porcentaje de cada categor√≠a
- ‚úÖ **Top 5 gastos m√°s altos**
- ‚úÖ **Comparaci√≥n con mes anterior**
- ‚úÖ Gr√°fica de pastel/barras
- ‚úÖ Tendencia mensual

---

### 12.3 Reporte de Rentabilidad

#### Pasos:
1. Seleccionar "Reporte de Rentabilidad"
2. Filtrar por mes

#### Verificar c√°lculos:
```
Ingresos: $50,000
Gastos fijos: $15,000
Gastos variables: $8,000 (de tratamientos)
Otros gastos: $5,000

Utilidad Bruta = Ingresos - Gastos variables = $42,000
Utilidad Neta = Ingresos - Todos los gastos = $22,000
Margen Neto = ($22,000 / $50,000) √ó 100 = 44%
```

#### Verificar:
- ‚úÖ C√°lculos matem√°ticos correctos
- ‚úÖ **Utilidad Bruta** calculada correctamente
- ‚úÖ **Utilidad Neta** calculada correctamente
- ‚úÖ **Margen de Utilidad** en porcentaje
- ‚úÖ Comparaci√≥n con meses anteriores
- ‚úÖ Indicadores de rendimiento (bueno/regular/malo)

---

### 12.4 Reporte de Servicios M√°s Rentables

#### Pasos:
1. Seleccionar "Servicios M√°s Rentables"
2. Ver an√°lisis

#### Verificar:
Para cada servicio, debe mostrar:
- ‚úÖ **Cantidad de veces realizado**
- ‚úÖ **Ingreso total generado**
- ‚úÖ **Costo promedio**
- ‚úÖ **Margen promedio**
- ‚úÖ **Rentabilidad**: (Ingreso - Costo) / Costo
- ‚úÖ Ordenado de m√°s a menos rentable

---

### 12.5 Reporte de Pacientes

#### Pasos:
1. Seleccionar "Reporte de Pacientes"

#### Verificar:
- ‚úÖ **Pacientes activos**: Con tratamiento en √∫ltimos 3 meses
- ‚úÖ **Pacientes inactivos**: Sin tratamiento en 3+ meses
- ‚úÖ **Valor promedio por paciente**: Total gastado / N√∫mero de pacientes
- ‚úÖ **Top 10 pacientes**: Los que m√°s han gastado
- ‚úÖ **Pacientes nuevos por mes**: Gr√°fica de adquisici√≥n
- ‚úÖ **Tasa de retenci√≥n**: Pacientes que regresan

---

### 12.6 Exportar Reportes

#### Pasos:
1. En cualquier reporte, click "Exportar"
2. Seleccionar formato: PDF o Excel
3. Descargar

#### Verificar:
- ‚úÖ Archivo descargado correctamente
- ‚úÖ **PDF**: Formato profesional, con logo, fecha, tablas y gr√°ficas
- ‚úÖ **Excel**: Datos en tabla, f√°cil de manipular, f√≥rmulas incluidas
- ‚úÖ Nombre del archivo incluye fecha y tipo de reporte

---

### 12.7 Filtros y Comparaciones

#### Probar:
1. Filtrar por rango de fechas personalizado
2. Comparar dos meses diferentes
3. Filtrar por servicio espec√≠fico
4. Filtrar por categor√≠a de gasto

#### Verificar:
- ‚úÖ Filtros se aplican correctamente
- ‚úÖ Gr√°ficas se actualizan
- ‚úÖ Totales se recalculan
- ‚úÖ Comparaciones muestran % de cambio

---

## 13. Punto de Equilibrio

**Ruta**: `/equilibrium`
**Dependencias**: Configuraci√≥n de Tiempo, Costos Fijos, Servicios
**Impacto**: An√°lisis financiero cr√≠tico

---

### 13.1 C√°lculo del Punto de Equilibrio

#### Pre-requisitos para el c√°lculo:
- Costos fijos totales: Ej. $15,000/mes
- Servicios con costos variables calculados
- Margen promedio de tratamientos

#### Pasos:
1. Ir a `/equilibrium`

#### Verificar c√°lculos:

**Supongamos:**
- Costos fijos mensuales: $15,000
- Costo variable promedio: 35% (del precio de venta)
- Margen de contribuci√≥n: 65%

```
Punto de Equilibrio = Costos Fijos / Margen de Contribuci√≥n
Punto de Equilibrio = $15,000 / 0.65
Punto de Equilibrio = $23,076.92
```

#### Verificar en la p√°gina:
- ‚úÖ **Costos fijos mensuales**: $15,000
- ‚úÖ **Margen de contribuci√≥n**: 65%
- ‚úÖ **Punto de equilibrio en ingresos**: $23,076.92
- ‚úÖ Si precio promedio por tratamiento es $1,500:
  - **Tratamientos necesarios**: $23,076.92 / $1,500 = 16 tratamientos/mes

---

### 13.2 An√°lisis de Escenarios

#### Verificar que puedas simular:

**Escenario 1: Aumentar costos fijos**
- Cambiar costos fijos a $18,000
- **Nuevo punto de equilibrio**: $27,692.31
- **Tratamientos necesarios**: 19

**Escenario 2: Reducir costos variables**
- Optimizar recetas para bajar costo variable a 30%
- Margen de contribuci√≥n: 70%
- **Nuevo punto de equilibrio**: $21,428.57
- **Tratamientos necesarios**: 15

**Escenario 3: Aumentar precios**
- Precio promedio de $1,500 a $1,800
- Costos fijos: $15,000
- **Tratamientos necesarios**: $23,076.92 / $1,800 = 13

#### Verificar:
- ‚úÖ Calculadora de escenarios funciona
- ‚úÖ Resultados actualizados en tiempo real
- ‚úÖ Gr√°ficas muestran impacto visual

---

### 13.3 Margen de Seguridad

#### Pasos:
1. Con ingresos actuales del mes: Ej. $35,000
2. Punto de equilibrio: $23,076.92

#### Verificar c√°lculo:
```
Margen de Seguridad = Ingresos Actuales - Punto de Equilibrio
Margen de Seguridad = $35,000 - $23,076.92 = $11,923.08

Porcentaje = ($11,923.08 / $35,000) √ó 100 = 34.07%
```

#### Verificar en la p√°gina:
- ‚úÖ **Margen de seguridad**: $11,923.08
- ‚úÖ **Porcentaje**: 34.07%
- ‚úÖ Indicador visual: Verde si > 30%, Amarillo si 15-30%, Rojo si < 15%
- ‚úÖ Interpretaci√≥n: "Est√°s 34% por encima del punto de equilibrio"

---

### 13.4 Gr√°fica de Punto de Equilibrio

#### Verificar:
- ‚úÖ **Eje X**: N√∫mero de tratamientos (0 a 30)
- ‚úÖ **Eje Y**: Ingresos/Costos en pesos
- ‚úÖ **L√≠nea roja**: Costos fijos (horizontal en $15,000)
- ‚úÖ **L√≠nea azul**: Costos totales (fijos + variables crecientes)
- ‚úÖ **L√≠nea verde**: Ingresos (crecimiento lineal)
- ‚úÖ **Punto de intersecci√≥n**: Donde se cruzan costos e ingresos (punto de equilibrio)
- ‚úÖ **√Årea sombreada**: Zona de p√©rdida (antes del punto) y zona de ganancia (despu√©s)

---

### 13.5 An√°lisis de Apalancamiento Operativo

#### Si existe esta m√©trica:
```
Apalancamiento Operativo = Margen de Contribuci√≥n / Utilidad Operativa

Ejemplo:
Ingresos: $35,000
Costos variables: $12,250 (35%)
Margen de contribuci√≥n: $22,750 (65%)
Costos fijos: $15,000
Utilidad operativa: $7,750

Apalancamiento = $22,750 / $7,750 = 2.94
```

#### Interpretaci√≥n:
- ‚úÖ Apalancamiento de 2.94 significa: Por cada 1% de aumento en ventas, la utilidad aumenta 2.94%
- ‚úÖ Indicador muestra sensibilidad del negocio a cambios en volumen

---

## 14. Marketing

**Ruta**: `/marketing`
**Dependencias**: Pacientes, Tratamientos
**Impacto**: An√°lisis de adquisici√≥n y ROI

---

### 14.1 Campa√±as de Marketing

#### Pasos:
1. Ir a `/marketing`
2. Click "Nueva Campa√±a"

#### Crear campa√±a:
- Nombre: "Promoci√≥n Limpieza Dental"
- Medio: "Facebook Ads"
- Fecha inicio: 01/03/2024
- Fecha fin: 31/03/2024
- Presupuesto: $2,000
- Objetivo: Adquirir 20 pacientes nuevos

#### Verificar:
- ‚úÖ Campa√±a aparece en lista
- ‚úÖ Estado: Activa / Finalizada (seg√∫n fechas)

---

### 14.2 Asignar Pacientes a Campa√±a

#### Pasos:
1. Al crear/editar paciente
2. Campo "Fuente": Seleccionar "Promoci√≥n Limpieza Dental"
3. Guardar

#### Crear 15 pacientes con esta fuente

#### Verificar en p√°gina de campa√±a:
- ‚úÖ **Pacientes adquiridos**: 15
- ‚úÖ **Costo por adquisici√≥n**: $2,000 / 15 = $133.33 por paciente

---

### 14.3 Calcular ROI de Campa√±a

#### Datos:
- Inversi√≥n: $2,000
- 15 pacientes adquiridos
- Cada paciente hizo en promedio 2 tratamientos
- Ingreso promedio: $1,500 por tratamiento
- Total ingresos generados: 15 √ó 2 √ó $1,500 = $45,000

#### Verificar c√°lculo de ROI:
```
ROI = ((Ingresos - Inversi√≥n) / Inversi√≥n) √ó 100
ROI = (($45,000 - $2,000) / $2,000) √ó 100 = 2,150%
```

#### Verificar en la p√°gina:
- ‚úÖ **Inversi√≥n**: $2,000
- ‚úÖ **Ingresos generados**: $45,000
- ‚úÖ **ROI**: 2,150%
- ‚úÖ **Ganancia neta**: $43,000
- ‚úÖ Indicador: Verde (ROI positivo)

---

### 14.4 Comparar Campa√±as

#### Crear 3 campa√±as con diferentes resultados:

**Campa√±a A: Facebook Ads**
- Inversi√≥n: $2,000
- Pacientes: 15
- ROI: 2,150%

**Campa√±a B: Google Ads**
- Inversi√≥n: $3,000
- Pacientes: 10
- ROI: 800%

**Campa√±a C: Volantes**
- Inversi√≥n: $500
- Pacientes: 3
- ROI: 500%

#### Verificar:
- ‚úÖ Tabla comparativa de campa√±as
- ‚úÖ Ordenar por ROI (mayor a menor)
- ‚úÖ Gr√°fica de barras con ROI de cada campa√±a
- ‚úÖ Recomendaci√≥n: "Facebook Ads es tu mejor canal"

---

### 14.5 Pacientes por Fuente

#### Verificar:
- ‚úÖ Gr√°fica de pastel: Distribuci√≥n de pacientes por fuente
  - Facebook Ads: 40%
  - Google Ads: 25%
  - Referidos: 20%
  - Volantes: 10%
  - Org√°nico: 5%
- ‚úÖ Tabla con detalle de cada fuente

---

### 14.6 An√°lisis de Retenci√≥n por Fuente

#### Verificar:
- ‚úÖ Tasa de retorno de pacientes seg√∫n su fuente
- ‚úÖ Valor de vida del cliente (LTV) por fuente
- ‚úÖ Ejemplo:
  - Pacientes de referidos: LTV $8,000
  - Pacientes de Facebook: LTV $5,500
  - Pacientes de volantes: LTV $3,000

---

## 15. Configuraci√≥n

**Ruta**: `/settings`

---

### 15.1 Configuraci√≥n de Cuenta

#### Pasos:
1. Ir a `/settings/account`

#### Verificar:
- ‚úÖ Nombre de usuario
- ‚úÖ Email (no editable)
- ‚úÖ Fecha de registro
- ‚úÖ Bot√≥n "Cambiar Contrase√±a"
- ‚úÖ Bot√≥n "Eliminar Cuenta" (con confirmaci√≥n doble)

---

### 15.2 Cambiar Contrase√±a

#### Pasos:
1. Click "Cambiar Contrase√±a"
2. Ingresar contrase√±a actual
3. Ingresar nueva contrase√±a (debe cumplir requisitos)
4. Confirmar nueva contrase√±a
5. Guardar

#### Verificar:
- ‚úÖ Validaci√≥n de requisitos:
  - M√≠nimo 8 caracteres
  - Al menos una may√∫scula
  - Al menos un n√∫mero
- ‚úÖ Contrase√±as deben coincidir
- ‚úÖ Mensaje de √©xito
- ‚úÖ Puedes hacer login con nueva contrase√±a

---

### 15.3 Preferencias

#### Pasos:
1. Ir a `/settings/preferences`

#### Verificar opciones:
- ‚úÖ **Idioma**: Espa√±ol / English
- ‚úÖ **Moneda**: MXN / USD / etc.
- ‚úÖ **Formato de fecha**: dd/mm/yyyy vs mm/dd/yyyy
- ‚úÖ **Zona horaria**: America/Mexico_City
- ‚úÖ **Notificaciones**: Email, Push

#### Cambiar idioma a ingl√©s:
- ‚úÖ Toda la UI se traduce
- ‚úÖ Montos siguen en formato correcto
- ‚úÖ Fechas cambian de formato

---

### 15.4 Seguridad

#### Pasos:
1. Ir a `/settings/security`

#### Verificar:
- ‚úÖ **Autenticaci√≥n de dos factores (2FA)**:
  - Estado: Activada / Desactivada
  - Bot√≥n para activar/desactivar
- ‚úÖ **Sesiones activas**:
  - Lista de dispositivos con sesi√≥n abierta
  - Bot√≥n "Cerrar todas las sesiones"
- ‚úÖ **Historial de actividad**:
  - Login, logout, cambios importantes

---

### 15.5 Gesti√≥n de Datos

#### Pasos:
1. Ir a `/settings/data`

#### Verificar opciones:

**Exportar Datos:**
- ‚úÖ Bot√≥n "Exportar todos mis datos"
- ‚úÖ Descarga archivo ZIP con:
  - Pacientes (CSV)
  - Tratamientos (CSV)
  - Gastos (CSV)
  - Configuraciones (JSON)

**Importar Datos:**
- ‚úÖ Subir archivo CSV con formato espec√≠fico
- ‚úÖ Validaci√≥n de formato
- ‚úÖ Preview antes de importar
- ‚úÖ Importaci√≥n exitosa con resumen

---

### 15.6 Eliminar Cuenta

**No automatizable - Requiere confirmaci√≥n extrema**

#### Pasos:
1. Ir a `/settings/account`
2. Click "Eliminar Cuenta"
3. **Primera confirmaci√≥n**: Di√°logo advierte que es PERMANENTE
4. **Segunda confirmaci√≥n**: Escribir "ELIMINAR" en campo de texto
5. Ingresar contrase√±a
6. Confirmar

#### Verificar:
- ‚úÖ No permite eliminaci√≥n accidental
- ‚úÖ Requiere m√∫ltiples confirmaciones
- ‚úÖ Despu√©s de eliminar:
  - Todos los datos se borran
  - Logout autom√°tico
  - No puedes hacer login con esa cuenta

---

### 15.7 Reset de Base de Datos

**EXTREMADAMENTE PELIGROSO - Solo en desarrollo**

#### Pasos:
1. Ir a `/settings/reset`
2. Click "Resetear Base de Datos"
3. Confirmar con contrase√±a

#### Verificar:
- ‚úÖ **TODOS los datos se eliminan**:
  - Configuraci√≥n de tiempo
  - Costos fijos
  - Activos
  - Insumos
  - Servicios
  - Pacientes
  - Tratamientos
  - Gastos
  - Marketing
- ‚úÖ Redirect a `/setup` (configuraci√≥n inicial)
- ‚úÖ App vuelve a estado "reci√©n instalada"

---

## 16. Multi-tenancy

**Objetivo**: Verificar aislamiento entre cl√≠nicas

---

### 16.1 Crear Segunda Cl√≠nica

#### Pasos:
1. En sidebar, click en selector de cl√≠nicas (dropdown)
2. Click "Agregar Cl√≠nica"
3. Llenar:
   - Nombre: "Cl√≠nica Sur"
   - Direcci√≥n: "Av. Sur 456"
4. Guardar

#### Verificar:
- ‚úÖ Nueva cl√≠nica aparece en selector
- ‚úÖ Al seleccionarla, cambia contexto

---

### 16.2 Configurar Segunda Cl√≠nica

#### En contexto de "Cl√≠nica Sur":
1. Configurar tiempo:
   - 18 d√≠as laborales
   - 9 horas por d√≠a
   - 70% efectividad
2. Agregar costos fijos: $12,000/mes
3. Crear diferentes insumos
4. Crear diferentes servicios

#### Verificar:
- ‚úÖ Configuraciones independientes de "Cl√≠nica Centro"

---

### 16.3 Verificar Aislamiento de Datos

#### Crear datos en "Cl√≠nica Sur":
- 3 pacientes
- 5 tratamientos
- 2 gastos

#### Cambiar a "Cl√≠nica Centro":

#### Verificar:
- ‚úÖ No ves los pacientes de "Cl√≠nica Sur"
- ‚úÖ No ves los tratamientos de "Cl√≠nica Sur"
- ‚úÖ Dashboard muestra solo datos de "Cl√≠nica Centro"
- ‚úÖ Reportes filtran por cl√≠nica actual

---

### 16.4 Comparar M√©tricas entre Cl√≠nicas

#### Crear tabla comparativa manual:

| M√©trica | Cl√≠nica Centro | Cl√≠nica Sur |
|---------|----------------|-------------|
| Costo/minuto | $15.63 | $13.50 |
| Pacientes | 25 | 3 |
| Tratamientos (mes) | 45 | 5 |
| Ingresos (mes) | $55,000 | $8,000 |
| Punto de equilibrio | $23,076 | $17,142 |

#### Verificar:
- ‚úÖ Cada cl√≠nica tiene m√©tricas independientes
- ‚úÖ Dashboard cambia al cambiar de cl√≠nica
- ‚úÖ (Si existe) Reporte consolidado muestra ambas cl√≠nicas

---

### 16.5 Eliminar Cl√≠nica

#### Pasos:
1. Ir a `/settings/workspaces`
2. Ver lista de cl√≠nicas
3. Click "Eliminar" en "Cl√≠nica Sur"
4. Confirmar

#### Verificar:
- ‚úÖ Advertencia si tiene datos
- ‚úÖ Al confirmar, cl√≠nica y TODOS sus datos se eliminan
- ‚úÖ Si eliminas la cl√≠nica activa, cambia autom√°ticamente a otra
- ‚úÖ No puedes eliminar la √∫ltima cl√≠nica

---

## üéØ Checklist General

### Flujo Completo de Usuario Nuevo

Ejecutar esta secuencia completa sin errores:

1. ‚úÖ Registro ‚Üí Verificaci√≥n email ‚Üí Login
2. ‚úÖ Onboarding: Crear workspace y cl√≠nica
3. ‚úÖ Setup: Configurar tiempo y costos fijos
4. ‚úÖ Crear 3 insumos
5. ‚úÖ Crear 2 servicios con recetas
6. ‚úÖ Crear 5 pacientes
7. ‚úÖ Crear 10 tratamientos (diferentes fechas)
8. ‚úÖ Crear 5 gastos
9. ‚úÖ Ver Dashboard actualizado con todos los datos
10. ‚úÖ Generar reporte de rentabilidad
11. ‚úÖ Verificar punto de equilibrio
12. ‚úÖ Exportar datos
13. ‚úÖ Crear segunda cl√≠nica
14. ‚úÖ Verificar aislamiento de datos
15. ‚úÖ Logout

---

## üßÆ Verificaciones Matem√°ticas Cr√≠ticas

### C√°lculo 1: Costo por Minuto
```
D√≠as laborales: 20
Horas por d√≠a: 8
Porcentaje real: 75%

Minutos efectivos = 20 √ó 8 √ó 60 √ó 0.75 = 7,200 min/mes

Costos fijos totales: $15,000

Costo por minuto = $15,000 / 7,200 = $2.08/min
```

### C√°lculo 2: Precio de Tratamiento
```
Servicio: 60 min, costo variable $100
Costo fijo: 60 √ó $2.08 = $124.80
Costo base: $124.80 + $100 = $224.80
Margen 40%: $224.80 √ó 0.40 = $89.92
Precio final: $224.80 + $89.92 = $314.72
```

### C√°lculo 3: Punto de Equilibrio
```
Costos fijos: $15,000
Margen de contribuci√≥n: 65%
Punto de equilibrio = $15,000 / 0.65 = $23,076.92
```

**IMPORTANTE**: Verifica MANUALMENTE cada uno de estos c√°lculos en la UI.

---

## üì± Pruebas de Responsividad

### Desktop (1920x1080)
- ‚úÖ Sidebar siempre visible
- ‚úÖ Tablas con todas las columnas
- ‚úÖ Gr√°ficas en tama√±o completo

### Tablet (768x1024)
- ‚úÖ Sidebar colapsable
- ‚úÖ Tablas con scroll horizontal
- ‚úÖ KPIs en 2 columnas

### Mobile (375x667)
- ‚úÖ Sidebar oculto, abre con men√∫ hamburguesa
- ‚úÖ Tablas responsive, columnas prioritarias
- ‚úÖ KPIs en 1 columna
- ‚úÖ Formularios adaptados (inputs full-width)

---

## üêõ Casos Borde y Errores

### Probar con Datos Inv√°lidos:
- ‚úÖ Campos vac√≠os en formularios ‚Üí Error claro
- ‚úÖ N√∫meros negativos donde no aplican ‚Üí Error
- ‚úÖ Fechas futuras en tratamientos ‚Üí Advertencia o permitido seg√∫n regla de negocio
- ‚úÖ Eliminar entidad con dependencias ‚Üí Error o confirmaci√≥n
- ‚úÖ Sesi√≥n expirada ‚Üí Redirect a login

### Probar sin Dependencias:
- ‚úÖ Crear tratamiento sin servicios ‚Üí Error claro
- ‚úÖ Ver tarifas sin configuraci√≥n de tiempo ‚Üí Mensaje de advertencia
- ‚úÖ Dashboard sin datos ‚Üí EmptyStates apropiados

---

## üìä M√©tricas de √âxito

### Performance:
- ‚úÖ P√°gina carga en < 2 segundos
- ‚úÖ Transiciones suaves (sin lag)
- ‚úÖ Tablas con 100+ registros cargan r√°pido

### UX:
- ‚úÖ Tooltips informativos en campos complejos
- ‚úÖ Mensajes de error claros
- ‚úÖ Confirmaciones para acciones destructivas
- ‚úÖ Feedback visual (spinners, toasts)

### Consistencia:
- ‚úÖ Iconos seg√∫n ICONOGRAPHY.md
- ‚úÖ Colores consistentes
- ‚úÖ Espaciado uniforme
- ‚úÖ Tipograf√≠a consistente

---

## üöÄ Siguiente Nivel

### Pruebas de Estr√©s:
- ‚úÖ Crear 1,000 pacientes
- ‚úÖ Crear 5,000 tratamientos
- ‚úÖ Generar reporte de a√±o completo
- ‚úÖ Verificar que no hay degradaci√≥n de performance

---

**Fin del Manual de Pruebas**

Este documento debe actualizarse cuando:
- Se agreguen nuevas funcionalidades
- Se modifiquen c√°lculos existentes
- Se detecten bugs en los flujos de prueba

**√öltima actualizaci√≥n**: 2025-10-16
